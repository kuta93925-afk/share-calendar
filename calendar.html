<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>カレンダー</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
    body { background-color: #f8f9fa; }
    #loginContainer {
        display: flex; align-items: center; justify-content: center; min-height: 90vh;
    }
    .login-box {
        width: 100%; max-width: 400px; padding: 2rem;
        background-color: white; border-radius: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }
    .calendar-wrapper {
        max-width: 1400px; margin: 20px auto; padding: 20px;
        background-color: white; border-radius: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }
    .calendar th, .calendar td {
        text-align: center; height: 130px; vertical-align: top;
        position: relative; border: 1px solid #dee2e6;
    }
    .calendar .sunday { color: #dc3545; }
    .calendar .saturday { color: #0d6efd; }
    td[data-date]:hover { background-color: #e9ecef; cursor: pointer; }
    .date-number { font-size: 0.9em; }
    .today .date-number {
        background-color: #0d6efd; color: white; border-radius: 50%;
        width: 28px; height: 28px; line-height: 28px; display: inline-block; font-weight: bold;
    }
    .other-month { color: #adb5bd; background-color: #f8f9fa; }
    .event-bar {
        position: relative; margin-top: 2px; height: 24px; line-height: 24px;
        color: white; border-radius: 4px; padding: 0 5px; font-size: 0.8em;
        overflow: hidden; text-overflow: ellipsis; white-space: nowrap;
        cursor: pointer; text-align: left; box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        transition: transform 0.2s;
    }
    .event-bar:hover { transform: scale(1.05); }
    .nav-tabs .nav-link { cursor: pointer; }
    .color-btn.selected { border: 2px solid black; transform: scale(1.2); }
</style>
</head>
<body>

<div class="container" id="loginContainer">
    <div class="login-box text-center">
        <h1 class="h3 mb-3">ログイン</h1>
        <div class="form-floating mb-3">
            <input type="text" id="loginUser" class="form-control" placeholder="ユーザー名" autocomplete="off">
            <label for="loginUser">ユーザー名 </label>
        </div>
        <button id="loginBtn" class="w-100 btn btn-lg btn-primary">ログイン</button>
        <p id="loginMsg" class="text-danger mt-2"></p>
    </div>
</div>

<div class="container-fluid calendar-wrapper" id="calendarContainer" style="display:none;">
    <div class="d-flex flex-wrap justify-content-between align-items-center pb-3 border-bottom mb-3">
        <div class="d-flex align-items-center">
            <h1 class="h3 mb-0 me-4">カレンダー</h1>
            <div class="btn-group">
                <button id="prevBtn" class="btn btn-primary">‹</button>
                <button id="todayBtn" class="btn btn-outline-secondary">今日</button>
                <button id="nextBtn" class="btn btn-primary">›</button>
            </div>
            <h2 id="calendar-title" class="h4 mb-0 mx-4"></h2>
        </div>
        <ul class="nav nav-tabs" id="calendarTabs">
            <li class="nav-item"><a class="nav-link active" data-calendar="my" href="#">拓己</a></li>
            <li class="nav-item"><a class="nav-link" data-calendar="partner" href="#">心春</a></li>
            <li class="nav-item"><a class="nav-link" data-calendar="shared" href="#">共有</a></li>
        </ul>
    </div>
    <div id="calendar" class="calendar"></div>
</div>

<div class="modal fade" id="eventModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header"><h5 class="modal-title">予定の編集</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
            <div class="modal-body">
                <input type="hidden" id="eventId">
                <div class="mb-2"><label>タイトル</label><input type="text" id="eventTitle" class="form-control"></div>
                <div class="mb-2 row">
                    <div class="col"><label>開始日</label><input type="date" id="eventStartDate" class="form-control"></div>
                    <div class="col"><label>時間</label><input type="time" id="eventStartTime" class="form-control"></div>
                </div>
                <div class="mb-2 row">
                    <div class="col"><label>終了日</label><input type="date" id="eventEndDate" class="form-control"></div>
                    <div class="col"><label>時間</label><input type="time" id="eventEndTime" class="form-control"></div>
                </div>
                <div class="mb-2"><label>色</label><div id="colorButtons" class="d-flex gap-2"></div></div>
                <div class="mb-2"><label>メモ</label><textarea id="eventMemo" class="form-control"></textarea></div>
            </div>
            <div class="modal-footer"><button type="button" id="deleteEventBtn" class="btn btn-danger">削除</button><button type="button" id="saveEventBtn" class="btn btn-primary">保存</button></div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="calendar.js"></script>
</body>
</html>